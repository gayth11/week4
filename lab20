import pandas as pd
import numpy as np
from sklearn.preprocessing import StandardScaler
df = pd.read_csv("day20_integration.csv")
print("Original Data:")
print(df.head())
df_encoded = pd.get_dummies(df, drop_first=True)
if "pages_viewed" in df.columns and "session_minutes" in df.columns:
    df_encoded["pages_per_min"] = (
        df["pages_viewed"] / (df["session_minutes"] + 1e-3)
    )
if "basket_value" in df.columns:
    df_encoded["basket_value_log"] = np.log1p(df["basket_value"])
scaler = StandardScaler()
numeric_cols = df_encoded.select_dtypes(include=np.number).columns
df_encoded[numeric_cols] = scaler.fit_transform(df_encoded[numeric_cols])
print("\n=== Before Engineering ===")
print(df.describe())
print("\n=== After Engineering ===")
print(df_encoded.describe())
